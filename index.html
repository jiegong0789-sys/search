<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>乘务四车间2024年6月公里数数据看板</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        :root {
            --primary-color: #1a73e8;
            --secondary-color: #4285f4;
            --accent-color: #34a853;
            --warning-color: #fbbc05;
            --danger-color: #ea4335;
            --light-gray: #f8f9fa;
            --dark-gray: #5f6368;
            --text-color: #202124;
            --border-color: #dadce0;
            --card-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-main);
            color: var(--text-color);
            background-color: #f5f7fa;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .kpi-card {
            background: white;
            border-radius: 10px;
            padding: 25px 20px;
            box-shadow: var(--card-shadow);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .kpi-card:hover {
            transform: translateY(-5px);
        }
        
        .kpi-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 10px 0;
            color: var(--primary-color);
        }
        
        .kpi-title {
            font-size: 1.1rem;
            color: var(--dark-gray);
        }
        
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            height: 450px;
        }
        
        .chart-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--text-color);
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .chart-title i {
            margin-right: 10px;
            color: var(--primary-color);
        }
        
        .chart {
            height: calc(100% - 30px);
            width: 100%;
        }
        
        .table-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }
        
        th {
            background-color: var(--light-gray);
            font-weight: 600;
        }
        
        tr:hover {
            background-color: rgba(26, 115, 232, 0.05);
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 400px;
            }
            
            header {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .kpi-container {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>乘务四车间2024年6月公里数数据看板</h1>
            <p class="subtitle">本看板展示了乘务四车间148名员工2024年6月每日公里数及汇总分析，帮助管理人员了解工作绩效与分布情况</p>
        </header>
        
        <div class="kpi-container">
            <div class="kpi-card">
                <div class="kpi-title">员工总数</div>
                <div class="kpi-value" id="total-employees">148</div>
                <div>参与公里数统计</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">总公里数</div>
                <div class="kpi-value" id="total-kilometers">348,309</div>
                <div>全车间月度累计</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">平均公里数</div>
                <div class="kpi-value" id="avg-kilometers">2,354</div>
                <div>人均月度里程</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">最高公里数</div>
                <div class="kpi-value" id="max-kilometers">3,424</div>
                <div>员工: 张正</div>
            </div>
        </div>
        
        <div class="chart-grid">
            <div class="chart-container">
                <div class="chart-title">员工公里数分布分析</div>
                <div id="distribution-chart" class="chart"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">员工公里数排名TOP 20</div>
                <div id="ranking-chart" class="chart"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">每日总公里数趋势</div>
                <div id="daily-trend-chart" class="chart"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">公里数区间人数分布</div>
                <div id="range-chart" class="chart"></div>
            </div>
        </div>
        
        <div class="table-container">
            <div class="chart-title">员工公里数完整数据表</div>
            <table id="data-table">
                <thead>
                    <tr>
                        <th>排名</th>
                        <th>工号</th>
                        <th>姓名</th>
                        <th>总公里数</th>
                        <th>平均每日</th>
                        <th>最高单日</th>
                        <th>最低单日</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- 数据将通过JS填充 -->
                </tbody>
            </table>
        </div>
        
        <div class="footer">
            <p>数据更新时间: 2024年6月30日 | 乘务四车间绩效分析看板</p>
            <p>© 2024 乘务四车间数据分析中心</p>
        </div>
    </div>

    <script>
        // 原始数据
        const rawData = `序号	工号	姓名	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	/	合计
1	208392	张正	198	182	50 		198	149	50		198 	149 	83		198 	149 	50		198 	149 	50		198 	149 	199	83	198 	149 	50		198 	149 		3424
2	208407	郭家成	198	182	215 	50 	198	149	50		198 	149 	83	198	198 	149 	50		198 	149 	50		198 	149 	50			149 	48		198 	149 		3405
3	206350	宋仁杰	149	83		198	149	213	50	198 	182 	166		198	149 	50		198	149 	50		198	149 	81		198	149 	50		198	149 	50 		3404
4	201157	曹显干	60	104	151	100		150 	150	170 			55 	150 	200 		57 	133 	170 	175 		200 	200 	132	200		150 	161 	180 	113 		155 		3316
5	204428	范钊	198	149	83 		198	149	81		198 	182 	50		198 	149 	50		198 	149 	50		198 	149 	81		198 	149 	50		198 	149 		3254
6	208372	彭涛	198	182	50 		198	149	17	116 	198 	182 	50		198 	149 	17		198 	149 	50		198 	149 	50		198 	149 	50		198 	149 		3242
7	210280	曹文浩		198	149	50		198	182 	50		198	149 	81		198	83 	83		198	149 	50		198 	149	50 		198	149 	83	198 	198 		3239
8	201356	汤宇翔		198	149	81		198	182 	232	17	198	149 	50		198	149 	50		198	149 	81			182		183	161	180 		95	155 		3235
9	208381	涂聪	198	182	50 		198	149	81	116 	198 	149 	81		198 	149 	50		198 	149 	50		198 	149 	50		198 	149 	50		82 	149 		3221
10	204366	汤涛	198	182	50 		198	149	50		198 	182 	50		198 	83 	83		198 	149 	50		198 	149 	50		198 	149 	81		198 	149 		3190
11	204340	刘奔		198	149	50		198 	182 	48		198	149 	50		198	149 	50		198	149 	50		198	149	81 		198	149 	118		198 		3107
12	208341	颜帅虎	198	182	50 		198	149			198 	182 	50		198 	83 	50		198 	149 	149	83	198 	149 	50		33 	116 	83		198 	149 		3093
13	210289	杨嘉程	198	182	17 		33	149	50		198 	149 	83		198 	149 	50		66 	149 	213	66	198 	149 	50		198 	149 	50		198 	149 		3091
14	208357	郭浩澜	198	149	199 	50 	198	149	48		198 	182 	17		198 				198 	149 	50		198 	149 	48		198 	149 	17		198 	149 		3089
15	209213	张子澳	182	33		198	149	50		198 	182 	50		198	149 	81		198	149 	50		198	149 	50		198	149 	81		198	149 	50 		3089
16	206537	陈凯	50	198	198	149 	50		198	182	50		198	149	48		198	149	50		198	149	50		198	149	50		198	149	50			3058
17	206536	陆森林		198	149	50		66	182 	232		198	83 	83		198	149 	50		198	149 	50		198	149	81 		198	149 	50		198 		3058
18	207460	邹旭东	149	50		198	149	50		198 	116 	83		198	149 	50		165	116 	83		198	149 	33		198	149 	17		198	149 	197 		3042
19	210310	吴洁丽	198	149	81 		198	149	50	116 	198 	182 			198 	149 	50		198 	116 	83		33 	116 	50		198 	99 	83		198 	149 		3041
20	208336	吴正海	182	50		198	149	50		198 	149 	81		198	149 	50		198	149 	48		198	149 	50		198	149 	50		198	149 	50 		3040
21	205400	张儒跃	198	83	83 		198	149	50		198 	182 			198 	149 	81		198 	149 	50		198 	149 	83		198 	149 	83		198 			3024
22	209211	谭雨涛	182	50		198	149	199	50	198 	149	50			149 	50		198	149 	50		198	149 	50		198	149 	50		198	149 	50 		3012
23	211127	刘煜	198	149	83 		198	149	50		198 	182 			198 	149 	33		198 	149 			198 	149 	50		198 	83 	50		198 	149 		3009
24	203708	李伟杰	81		198	149 	50		165	182	50		198	83	83		198	149	50		198	149	50		198	149	230		198	149	50			3007
25	206534	赵杰		198	149	48 		198	182 	50		198	149 	50		198				198	149 	182	66	198	149	50 		198	149 	50		198 		3007
26	208332	毛传鑫	83		198	83 	83		198	149	50			149	199	50 	198	149	83		198	83	50	198 	198	83	83		198	149	83			2995
27	206525	曹磊	165	149	50 		198	149	50		198 	149 	48		198 	149 	50		198 	83 	50		198 	149 	50		198 	116 	83		198 	116 		2992
28	207888	傅座衔		182		116 	66	33			198 	149 	50		198 	149 	48	149	198 	149 	182	66	198 	149 	33		198 	149 	50		198 	83		2991
29	207294	马清	149	50		198	149	48	198	198 	182	17		198	149 	50		198	149 	50		198	149 	48		198				66	149 	197 		2988
30	206315	刘海巍	182	50		198	83	50	116	198 	149 	199	50		116 	83		165	116 	83		198	99 	83	165	33	83 	83		198	149 	50 		2979
31	208353	范波	50		198	116 	149	83	198	149	50		198	99	83		198	149	50		198	149	17		198	149	50	50 	198	149	50			2978
32	206365	胡顺		198	149	50		198	182 	50		198	149 	50		198	149 	17		198	149 	50		198	149	50 		198	149 	50		198 		2977
33	203983	夏念	50		198	149 	50		198	149	232		198	149	50		198	149	81		198	149	17		198	149	50		198	83	81			2974
34	206563	何星成		182	50		198	149	50 		198 	182	50 		198 	149	50 		198 	149	50 		198	149	17		198 	149	50 		198 	149 		2961
35	204348	刘思佳	198	182	50 		198	149	17		198 	182 	50		198 	149 	50			149 	50		198 	116 	83		198 	149 	50		198 	149 		2961
36	205755	郭惠和	182	50		198	149	50		198 	182 	50		198	149 			198	149 	50		198	149 	17		198	149 	50		198	149 	50 		2961
37	201187	胡宏	60	104	151 	20		150	150	170 			55	150	200 		57	133	170 	175		182			182		183 	180	160		95 	220 		2947
38	207454	钟威	83		198	149 	50		198	149	50		198	149	81		198	149	50		198	149	50		198	149	50		198	149	66			2909
39	207414	丁旺	50		198	149 	50		198	182	50		66	149	50		198	83	83		198	149	50	198 		149	182	66 	198	149	50			2895
40	211118	欧阳佳翼		198	149 	17 		198	182	50 		198	149	50		198	149	48		198	149				149	50		198	83	230	50	198		2891
41	211239	朱金伟			198	149 	111	5	158	182	50		198	149 	17		198	149 	50		198	149 	50		198	149	83	42 	198	149 	50			2880
42	208406	高权		198	83	83			182 	50		198	149 	50		198	149 	83		198	149 	50		198	149	50 		198	149 	116		198 		2878
43	205396	邓志坚	198	149	100 		198	149	50	198 	198 	116 	83		198 	149 	50		198 	149 	17		68 	149 	48	66	198 	149 						2878
44	207444	颜偲		198	149	50		198	149 	83		198				198	149 	50		198	149 	50		198	149	50 	66	198	149 	50		198 		2877
45	201348	戚伯龙	149	149		132	198	66	115	40	182	50		198	66	116		198	66	132 	66	99	116	118		198		68		198	149			2869
46	207458	朱伟		198	149	50		198	182 	50		198	149 	81		198	149 	50		198	149 	50			116	83 		198	149 	50		198 		2843
47	205776	刘佳慧		198	149	50		198	182 	50		198	149 	50		198	149 	81		198	149 	50			149	50 		198	149 	50		198 		2843
48	210291	邓畅	182		198 	198	149	50		198 				132	149 	48		198	149 	50		198	149 			198	149 	50		198	149 	50 		2842
49	209207	潘思安	198	182	50		198	149	50		198 	149	81		198 	149 	50		198 	149 	48		198 	149 	50		198	149	50					2841
50	207440	肖凌峰		198	149	81		198	149 	50		198	149 	50		198	149 	50		198	149 	48		198	149	50 		158	149 	118				2836
51	204082	陈良		198	149	50		198	149 	83		198				198	149 	50		198	149 	50		198	116	83 		198	149 	197	48			2808
52	209935	王瑞林	182	50		198	116	83		198 	149 	83		198	99 	83		198	83 	83		198	149 	50			149 	50		198	149 	50 		2796
53	207411	陈鹏	182	48		198	149	133	83		149 	50			149 	50		198	149 	199	81		149 	50		198	149 	50		182	149 	50 		2795
54	208433	张权	83	83		198	149	50	116	198 	149 	50		198	149 	81			149 	50		198	149 	50		198	149 	50		66	149 	81 		2793
55	206524	谢森杰	50		198	149 			198	182	232			83	50		198	149	50		198	116	116		165	116	83		198	149	83			2763
56	209936	彭荣杰	182	50			149	50		198 	182 	50		198	149 	50		198	149 	81		198	83 			198	149 	50		198	149 	50 		2761
57	207467	刘志翔		198	149	50		198	149 	83		198	149 	50		198	149 	50			149 	17		198	149	50 		198	149 	17		198 		2746
58	204374	彭哲	182	50			149			198 	149 	81		198	83 	50		198	149 	50		198	116 	83		33	116 	83		198	149 	230 		2743
59	208436	朱倚剑	50		198	99 	83		198	149	81		66	83	83		198	149	83		198	149	50	198 	198	149	81		198					2741
60	208419	刘勇	50		198	149 	50		198	116	83		198	149	50		165	149	17		198	149	50		198	149	17		198	149	48			2728
61	208412	蒋光辉	182	83		33	83	83		198 				198	149 	50		198	149 	149	83	66	149 	81		198	83 	83		198	149 	83 		2728
62	211123	吴雍卓		116	99	83		198	182 	50		198	149 	48		198	149 	50		198	149 	50			149	50 		198	116 	99		198		2727
63	205011	刘程	182	50		189	120	40		158 	119 	83		198	149 	50		198	149 	50		198	149 	50		198	149 	48			149 	50 		2726
64	204433	赵斌	149	83		33	116	83	198	198 	149 	83	198	33	83 	83						198	149 	50		198	149 	50		198	149 	83 		2713
65	205391	池日洋	50		198	149 	17		198	182	50			149	17		198	149	48		198	149		165 	198	149	50		198	149	50			2711
66	208378	唐杰	116					149	83		198 	182 	17	198	33 	149 	81		198 	83 	83		198 	149 	50		198 	149 	50		198 	149 		2711
67	205004	戴湘泉	17		198	149 	50		198	149	50		198	149	50		198	149	50		198	149	50		165	149	17		198	83	83			2697
68	208425	王欣洋	149	83		198	149	50		198 	182 	50		198				198	149 			198	149 	50		198	83 	50		198	83 	83 		2696
69	204432	李杰	149	50		198	149	50		198 	149 	48		198	149 	50		165	83 	50		198	149 	50		198	116 	83			116 	83 		2679
70	208382	万权	182	50		198				198 	149 	50		198	149 	50		198	149 	81		198	149 	50		198	149 	50		33	149 	50 		2678
71	211237	文韫	182	50		198	119	12		198 	182	50		198	149 	50		165	149 	17		198	119 		30	158	149 	50		198	30 	10 		2661
72	204423	伍盛阳	182	50			149	17		198 	149 	50		198	149 	17		198	149 	50		198	83 	50		198	149 	50		198	149 	17 		2648
73	204391	周术林	149	50		198	99	83		198 	182	50	198	66				198	149 	50		198	149 	50		66	149 	81	33	198	33 			2627
74	208376	阙斌	48		198	149 	50		198				198	149	50		198	149	50		198	149	50		198	149	48		198	149	50			2626
75	204393	周泽		165	116	232 	50	198	182 	50		198	83 	83						198	149 	50		198	149	50 		66	149 	50		198 		2614
76	204386	李蔚然							198	198 	182 	199	50		149 	17		198	149 	50		200	200 	132	200		150 			113		220 		2605
77	208400	曹嘉轩	165	149	50 		198	99	83		198 	182 	50		198 				198 	149 	50		33 	149 	50		66 	149 	81		198 	83 		2578
78	204446	李慧	50		198	83 	50		132	149	50		198	116	268		198	116	50		198	99	66			63	232		66	119	63			2564
79	204450	段宋林		198	149	17 		198	182 	48		198	149 			198	149 	50		198	130 	185		100	130			40	149 	50		40 		2558
80	208339	谢旺		165	116	116		33	182 	50		83	99 	83		33	149 	50		198	83 	83		198	149	83 		198	149 	50		198 		2548
81	209363	彭柠	50		198	149 	50		198	149	81			149	50		198	149	83		198		50		198	149	50		198	149	50			2546
82	208351	陈文彬		149	83 		198	149	50		198 	149 	50		198 	149 	48		198 	149 	17		198 	149 	50		198 	149 	17					2546
83	206557	刘昌奇		165				198	149 	83		198	149 	17		198	149 	50		198	149 	17		198	149	50 		198	149 			40 		2504
84	204444	邱毅波	48			83 	83		198	149	50		132	149	50		198	149	50		198	149	50		198	149	50		198	83	83			2497
85	206327	温港荣	50		33				182 	199	48	198	149 	50		66	149 	197	83		33 			198	149	50 	50	198	149 	50		198 		2479
86	203535	刘鹏			149	50 		198	182 	81		198	149 	50		198	149 	50		198	149 	50						198	149 	50		198 		2446
87	204454	周涛		198	149			198	182 	50		30	83 	50		198	149 	33			116 	83		165	116	50 		198	99 	83		198 		2428
88	208409	韩旭宇	149	83		198	149	50						66	83 	83		198	83 	83		198	149 	50		198	149 	50		198	149 	50 		2416
89	205003	陈云	50		198	149 	50		198	120	50		198	120	40		198	149	81		198	149	50		198	149	50							2395
90	204364	叶融仁	50			149 	50			149	83		198	149	81		149	130	50		100	149	81	83 	198	66	83		198	149	50			2395
91	206490	阳梦宇	182			66	149	81	116	198 	149 	48		198	149 	50			149 	50		198	149 	48		198					149 	66 		2393
92	204404	罗伟			198	149 	50		83	182	17		198	149	50		165	149	50		198	149	50			83	50		198	149	50			2367
93	208387	伍玉江	198	182	50 		198	83	50	198 	198 					116 	83		33 	116 	83		198 	149 	83		33 	83 	83		116 	33 		2366
94	203722	胡佳骏			149	50 		198	182 	17		198	149 	50		198	116 	83		198	149 	50			149	50 		33	83 	83		149 		2334
95	204395	张家豪			66	99			198	149	48		99	66	83		198	198			198	149	50		149	99		132	198	66		83 		2328
96	208066	唐明跃	198	130	83 	198 	100	130			198 	149 	50		100 	196 			100 	130 			100 	130 			100 	130 			100 			2322
97	205382	曾余意	165	149	83 		33	116	83		83 	149 	83		33 	83 	83						198 	149 	50		198 	149 	50		198 	149 		2284
98	207461	左星宇	198	182	50 		198	116	83		198 	149 	50		198 	99 	83		33 	83 	83		10 	68 			198 	149 	50					2278
99	207452	张永桂	50									116 	198	149	50		198	149	50		198	149	48		198	149	50		198	149	81			2180
100	208401	陈航		198	149	50		198	182 	50		198	149 	50		198	149 	50		33	116 	83		116				33	83 	83				2168
101	209209	陈波屿					198	17			198 	182 			66 	116 	83		198 				198 	149 	50		198 	83 	83		198 	149 		2166
102	211370	吕亚周	165	149	50 		198	66	83		198 	149	83		198 	149	50		198 				40 	23	17		158 	53	66		40 	30 		2163
103	206312	李启明	50		198	149 	50						198	149	50		165	116	83		198	33			165	116	232		33	149	17			2151
104	209206	李栋梁	81		198	149 	50		132	182	17		33	116	83		116	149	83		58	83	83		4	68		66 	198	149	50			2148
105	206528	张源麒	198	182	48 		198												198 	149 	50		198 	165 			198 	149 	50		198 	149 		2130
106	208362	李盼	198	182	50 		198				116 	149 	50			149 	50		198 				198 	83 	83		198 	149 	50					2101
107	208369	龙杰	83									50 	198	149	50		198	149	50		198	83	83		198	149	50		198	149	50			2085
108	205770	贺瑾						198	149 	81		198	116 	83		198	149 	83			83 	83			33			198	149 	83		198 		2082
109	203439	张梃	130			198	130			198 	130			198	130 			100	130 			100	130 			100	130 			100	130 			2034
110	206217	唐林	100	130			100	130			100 	130 			100 	130 			100 	130 	66	83	100 	68 			100 	130 			198 	130 		2025
111	206333	彭宇清		116	149	66		132	248							198	116	83		66	33			198	149	50		90	116			198 		2008
112	208391	张磊	182	50		198				198 	182			33	116 	83		116	99 	83		33	83 	83			33 			198	149 	83 		2002
113	206221	黄鑫	83		33	149 	48		198				198	149	50		198				66	149	81		198	149	50		198					1997
114	204349	李中泽	198			40			116 	149 	199 	232	50	132	198 	66		83	198 	66										99	149 			1975
115	210276	刘博文	83		198	149 	17		198	182	50		198	149			198	149											198	149	50			1968
116	207423	刘志谦			198					182			198	149	50		165	149	17		33	116	83	83 	116	99	83		33	149	48			1951
117	204345	张浩				198	149	50			149 	50		198	149 	50			149 	17			68 	68		198	149 	17	38	50	185 			1932
118	201262	曾武林		100	130	66	83	100 	130 			100	130 			100	130 			100	130			198	130		99	100				100 		1926
119	208344	易胜民										198	149 	50			149 	50		198	149 	50		165	149	17 		198	149 	50		198 		1919
120	206558	张戈强	116	50		132	198	66		198 	149	33	66	116					66	83 		99	99			99	33			99	198 			1900
121	207470	唐斌		182	81 			83	83						198 	149 	50		198 	149 	50		66 	149 	81			33 			198 	149 		1899
122	207445	杨尚升		165	83	50 		33	182 	33		198	116 	83		33	116 	50						198	149	50 			157 			198 		1894
123	208342	杨景		198	83	83		198				198	149 	17										198	83	199 	50	198				198 		1852
124	205397	曾湘鑫	149	198			99	99							99	99				99		132	198	50		132	198				116	149 		1817
125	206526	戴凯	100	130			100	130			100 	130 				130 			100 	130 			100 	130 			100 	130 	68		100 	130 		1808
126	207451	张毅勋	83		33	116 	83		198	149	83		33				186				198	149	50		198	149	50			33				1791
127	203061	陈明		198	149	50		198	182 	199		198	149 	50															149 	50		198 		1770
128	204356	喻祖军			66	149 	81		100	182	50			130			100	130			100	66	149		198				100	83	83			1767
129	205024	王英雄					33		132	149	50		50	99			186				99	37		149 	198	99		132 	198	66		83 		1760
130	207410	曾楚源	149	81		198	149	50			182 	17										33	116 			198	99 	83		198	149 	48 		1750
131	203438	吴远桂		33			83	83	99		182 		198	66		132	83	149 		99		198	33		33	116		50			33			1670
132	204392	莫泽新				39	29	10			30			132	198	66		83	198	66		116	99			68				198	83	83 		1498
133	204434	蒋瀚																		198	83 	50		198 	149	199 		198 	116 	83		198 		1472
134	211372	秦民杰		40	13 	17 		158	145	13 		40	14	17		158	119	40		7	30	16			119	66		158	14	66		158		1408
135	206318	陶治	66		198					149	33		198	130			20	149	50		25	178			198									1394
136	205388	刘稳	83	149			99	99				149 	50		185				99	158								99		132	83			1385
137	205411	黎孜		83	198	66		132	248			116				10				198	99				33			90	99					1372
138	203446	王信实		17							116 		198		99 	116 		198						83 			99 	99 		132	83 	116 		1356
139	204430	解震宇			99				182	17	198 		99	99			149			132	66			83	83				66	68				1341
140	204417	魏明玮					116	116			116				198 	149 	50		116	116			132			132	66					33 		1340
141	206535	寻春成			33							116	198	66		132	83			198	116			149	83	66		66 	33					1339
142	211126	罗杰文		158	53 	66 		40	37	4 		158	52	66		40	30	10		26	119	65			30	17		40	52	17		158		1238
143	205383	王希	198	33			33	33			198 				116 	66 				158 											185 	149 		1169
144	205384	詹强																		66 	83		158 	93 	66		40 	13 	17		158 	119 		813
145	205385	左词洁			99	99																							198	165		149 		710
146	205386	戴澔																					30 		119	40	33 	41		198	119 	40 		620
147	205387	彭凯雄							40	29				29 	10								17			20				30 	20			195
148	205388	杨仲				66								66																				132`;

        // 数据处理函数
        function processData(rawData) {
            const lines = rawData.split('\n');
            const result = [];
            let totalKilometers = 0;
            
            // 从第三行开始处理数据（跳过标题和表头）
            for (let i = 2; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const columns = line.split(/\t+/);
                if (columns.length < 35) continue;
                
                // 提取基础信息
                const employee = {
                    rank: parseInt(columns[0]),
                    employeeId: columns[1],
                    name: columns[2],
                    total: parseInt(columns[columns.length - 1]) || 0
                };
                
                // 处理每日数据
                employee.dailyData = [];
                for (let j = 3; j < 33; j++) {
                    const value = columns[j].trim();
                    employee.dailyData.push(value === '' ? 0 : parseInt(value) || 0);
                }
                
                // 计算统计数据
                employee.dailyAvg = Math.round(employee.total / 30);
                employee.maxDaily = Math.max(...employee.dailyData);
                employee.minDaily = Math.min(...employee.dailyData.filter(v => v > 0));
                
                result.push(employee);
                totalKilometers += employee.total;
            }
            
            // 按总公里数排序
            result.sort((a, b) => b.total - a.total);
            
            return {
                employees: result,
                totalEmployees: result.length,
                totalKilometers,
                avgKilometers: Math.round(totalKilometers / result.length)
            };
        }
        
        // 初始化ECharts图表
        function initCharts(data) {
            // 1. 员工公里数分布分析
            const distributionChart = echarts.init(document.getElementById('distribution-chart'));
            const distributionOption = {
                tooltip: {
                    trigger: 'axis',
                    formatter: '{b}: {c} 公里'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: data.employees.map(e => e.name),
                    axisLabel: {
                        interval: 0,
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    name: '公里数'
                },
                dataZoom: [{
                    type: 'inside',
                    start: 0,
                    end: 20
                }, {
                    start: 0,
                    end: 20
                }],
                series: [{
                    name: '总公里数',
                    type: 'bar',
                    data: data.employees.map(e => e.total),
                    itemStyle: {
                        color: function(params) {
                            const colorList = [
                                '#5470c6', '#91cc75', '#fac858', '#ee6666', '#73c0de',
                                '#3ba272', '#fc8452', '#9a60b4', '#ea7ccc'
                            ];
                            return colorList[params.dataIndex % colorList.length];
                        }
                    },
                    emphasis: {
                        focus: 'series'
                    }
                }],
                toolbox: {
                    feature: {
                        saveAsImage: {},
                        dataView: {readOnly: false}
                    }
                }
            };
            distributionChart.setOption(distributionOption);
            
            // 2. 员工公里数排名TOP 20
            const top20 = data.employees.slice(0, 20);
            const rankingChart = echarts.init(document.getElementById('ranking-chart'));
            const rankingOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    },
                    formatter: '{b}: {c} 公里'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    name: '公里数'
                },
                yAxis: {
                    type: 'category',
                    data: top20.map(e => e.name),
                    inverse: true
                },
                series: [{
                    name: '总公里数',
                    type: 'bar',
                    data: top20.map(e => e.total),
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                            offset: 0,
                            color: '#83bff6'
                        }, {
                            offset: 0.5,
                            color: '#188df0'
                        }, {
                            offset: 1,
                            color: '#188df0'
                        }])
                    },
                    emphasis: {
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                                offset: 0,
                                color: '#2378f7'
                            }, {
                                offset: 0.7,
                                color: '#2378f7'
                            }, {
                                offset: 1,
                                color: '#83bff6'
                            }])
                        }
                    }
                }],
                toolbox: {
                    feature: {
                        saveAsImage: {},
                        dataView: {readOnly: false}
                    }
                }
            };
            rankingChart.setOption(rankingOption);
            
            // 3. 每日总公里数趋势
            const dailyTotals = Array(30).fill(0);
            data.employees.forEach(employee => {
                employee.dailyData.forEach((value, index) => {
                    dailyTotals[index] += value;
                });
            });
            
            const trendChart = echarts.init(document.getElementById('daily-trend-chart'));
            const trendOption = {
                tooltip: {
                    trigger: 'axis',
                    formatter: '第 {b} 天: {c} 公里'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: Array.from({length: 30}, (_, i) => i + 1)
                },
                yAxis: {
                    type: 'value',
                    name: '公里数'
                },
                dataZoom: [{
                    type: 'inside',
                    start: 0,
                    end: 100
                }],
                series: [{
                    name: '每日总公里数',
                    type: 'line',
                    smooth: true,
                    symbol: 'circle',
                    symbolSize: 8,
                    data: dailyTotals,
                    lineStyle: {
                        width: 4,
                        color: '#ee6666'
                    },
                    areaStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            {offset: 0, color: 'rgba(238, 102, 102, 0.6)'},
                            {offset: 1, color: 'rgba(238, 102, 102, 0.1)'}
                        ])
                    },
                    markPoint: {
                        data: [
                            {type: 'max', name: '最大值'},
                            {type: 'min', name: '最小值'}
                        ]
                    }
                }],
                toolbox: {
                    feature: {
                        saveAsImage: {},
                        dataView: {readOnly: false}
                    }
                }
            };
            trendChart.setOption(trendOption);
            
            // 4. 公里数区间人数分布
            const ranges = [
                {min: 0, max: 1499, label: '<1500'},
                {min: 1500, max: 1999, label: '1500-1999'},
                {min: 2000, max: 2499, label: '2000-2499'},
                {min: 2500, max: 2999, label: '2500-2999'},
                {min: 3000, max: 10000, label: '≥3000'}
            ];
            
            const rangeCounts = ranges.map(range => {
                return data.employees.filter(e => 
                    e.total >= range.min && e.total <= range.max
                ).length;
            });
            
            const rangeChart = echarts.init(document.getElementById('range-chart'));
            const rangeOption = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} 人 ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    right: 10,
                    top: 'center'
                },
                series: [{
                    name: '公里数分布',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 10,
                        borderColor: '#fff',
                        borderWidth: 2
                    },
                    label: {
                        show: false,
                        position: 'center'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: '18',
                            fontWeight: 'bold'
                        }
                    },
                    labelLine: {
                        show: false
                    },
                    data: ranges.map((range, index) => {
                        return {
                            value: rangeCounts[index],
                            name: range.label,
                            itemStyle: {
                                color: ['#5470c6', '#91cc75', '#fac858', '#ee6666', '#73c0de'][index]
                            }
                        };
                    })
                }],
                toolbox: {
                    feature: {
                        saveAsImage: {}
                    }
                }
            };
            rangeChart.setOption(rangeOption);
            
            // 窗口大小调整时重新渲染图表
            window.addEventListener('resize', function() {
                distributionChart.resize();
                rankingChart.resize();
                trendChart.resize();
                rangeChart.resize();
            });
            
            return {
                distributionChart,
                rankingChart,
                trendChart,
                rangeChart
            };
        }
        
        // 渲染表格
        function renderDataTable(data) {
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = '';
            
            data.employees.forEach(employee => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${employee.rank}</td>
                    <td>${employee.employeeId}</td>
                    <td>${employee.name}</td>
                    <td>${employee.total.toLocaleString()}</td>
                    <td>${employee.dailyAvg.toLocaleString()}</td>
                    <td>${employee.maxDaily.toLocaleString()}</td>
                    <td>${employee.minDaily ? employee.minDaily.toLocaleString() : '-'}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // 更新KPI卡片
        function updateKPICards(data) {
            document.getElementById('total-employees').textContent = data.totalEmployees;
            document.getElementById('total-kilometers').textContent = 
                data.totalKilometers.toLocaleString();
            document.getElementById('avg-kilometers').textContent = 
                data.avgKilometers.toLocaleString();
            
            const topEmployee = data.employees[0];
            document.getElementById('max-kilometers').textContent = 
                topEmployee.total.toLocaleString();
        }
        
        // 主初始化函数
        function initDashboard() {
            const processedData = processData(rawData);
            
            // 更新KPI卡片
            updateKPICards(processedData);
            
            // 初始化图表
            initCharts(processedData);
            
            // 渲染表格
            renderDataTable(processedData);
        }
        
        // 页面加载完成后初始化看板
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>
